{% extends 'global/skeleton.html' %}

{% block pagename %}Risultati Opzione Singola{% endblock pagename %}

{% block content %}
<div class="container text-center mt-2 mb-5">
    <div class="row">
        <div class="col">
            <h1 class="fw-normal">Risultati della scelta: {{poll_results.poll.name}}</h1>
        </div>
    </div>
    <div class="row text-start text-white bg-secondary">
        <div class="col-auto pe-0">
            <p class="fw-light  fs-4 mb-0 pt-1 pb-1 ">Domanda posta:</p>
        </div>
        <div class="col ps-2">
            <p class=" fw-light fs-4 mb-0 pt-1 pb-1 ">{{poll_results.poll.question}} </p>
        </div>
    </div>
    <!-- SO results -->
    {%for voted_option in poll_results.get_sorted_options %}
        <div class="row m-3">
            <div class="col-1 fs-4 pt-1 {%if forloop.counter == 1%}bg-success {%else%}bg-primary {%endif%}text-center text-white ">
                {{forloop.counter}}
            </div>
            <div class="col-5 fs-5 fw-light ms-1 pt-1 bg-light text-start">
                {{ voted_option.option.value|truncatechars:20 }}
            </div>
            <div class="col fs-5 fw-light ms-1 pt-1 bg-light">
                {{voted_option.n_votes}} {%if voted_option.n_votes == 1%}preferenza{%else%}preferenze{%endif%}
            </div>
        </div>
        <hr />
    {% endfor %}
</div>

<!-- Poll data -->
<div class="container border  pb-1">
    <div class="row mt-0 text-start bg-primary ">
        <p class="mb-0 fs-4 text-white fw-light ">
            Dettagli
        </p>
    </div>
    {% include 'polls_management/components/poll_info.html' with poll=poll_results.poll poll_info_to_view=poll_info_to_view %}
</div>
<div class="container text-center mt-2 mb-5">
    <!-- Buttons -->
    <div class="row">
        <div class="d-grid gap-2 d-md-block">
            <button type="button" class="btn btn-info" 
                data-bs-toggle="modal" data-bs-target="#shareModal-{{poll_results.poll.id}}">
                Condividi 
            </button>
            {% include "polls_management/components/share_social/share_social_modal.html" with poll=poll_results.poll %}
            <a
                class="btn btn-primary" 
                href="{% url 'apps.votes_results:votable_polls' %}?page=1&per_page=10" >
                Ritorna alla lista di tutte le scelte
            </a>
            <a name="" id="" role="button"
                class="btn btn-secondary" 
                href="https://github.com/SDF-Ingegneria-2022/smoothPoll/issues" 
                target="_blank">
                Lasciaci un Feedback
            </a>
        </div>
    </div>   
</div>

{% endblock content %}

{% block customjs %}

{% include 'polls_management/components/copy_link/copy_link_script.html' with poll=poll %}

{% endblock customjs %}